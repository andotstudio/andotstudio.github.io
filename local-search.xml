<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>什么是ClickHouse？</title>
    <link href="/2020/10/17/bigdata/clickhouse/introduction/what-is-clickhouse/"/>
    <url>/2020/10/17/bigdata/clickhouse/introduction/what-is-clickhouse/</url>
    
    <content type="html"><![CDATA[<h1 id="什么是ClickHouse"><a href="#什么是ClickHouse" class="headerlink" title="什么是ClickHouse"></a>什么是ClickHouse</h1><blockquote><p>ClickHouse是一个面向列的数据库管理系统（DBMS），用于联机分析处理查询（OLAP）。</p></blockquote><p>在面向行的“普通”DBMS中，数据按以下顺序存储：</p><table><thead><tr><th>Row</th><th>WatchID</th><th>JavaEnable</th><th>Title</th><th>GoodEvent</th><th>EventTime</th></tr></thead><tbody><tr><td>#0</td><td>89354350662</td><td>1</td><td>Investor Relations</td><td>1</td><td>2016-05-18 05:19:20</td></tr><tr><td>#1</td><td>90329509958</td><td>0</td><td>Contact us</td><td>1</td><td>2016-05-18 08:10:20</td></tr><tr><td>#2</td><td>89953706054</td><td>1</td><td>Mission</td><td>1</td><td>2016-05-18 07:38:00</td></tr><tr><td>#N</td><td>…</td><td>…</td><td>…</td><td>…</td><td>…</td></tr></tbody></table>]]></content>
    
    
    
    <tags>
      
      <tag>ClickHouse,BigData,Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Spring Security OAuth2 Resource Server 创建</title>
    <link href="/2020/10/15/spring/security/oauth/resource-server/"/>
    <url>/2020/10/15/spring/security/oauth/resource-server/</url>
    
    <content type="html"><![CDATA[<h1 id="Spring-Security-OAuth2-Resource-Server-创建"><a href="#Spring-Security-OAuth2-Resource-Server-创建" class="headerlink" title="Spring Security OAuth2 Resource Server 创建"></a>Spring Security OAuth2 Resource Server 创建</h1>]]></content>
    
    
    
    <tags>
      
      <tag>Security,Spring Security,OAuth2,Resource Server,Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Spring Boot 更换 Logging 框架为 Log4J2</title>
    <link href="/2020/10/14/every_little_bit/spring/boot/springboot-log4j2/"/>
    <url>/2020/10/14/every_little_bit/spring/boot/springboot-log4j2/</url>
    
    <content type="html"><![CDATA[<h1 id="Spring-Boot-更换-Logging-框架为-Log4J2"><a href="#Spring-Boot-更换-Logging-框架为-Log4J2" class="headerlink" title="Spring Boot 更换 Logging 框架为 Log4J2"></a>Spring Boot 更换 Logging 框架为 Log4J2</h1><h3 id="排除掉SpringBoot现有Logback依赖"><a href="#排除掉SpringBoot现有Logback依赖" class="headerlink" title="排除掉SpringBoot现有Logback依赖"></a>排除掉SpringBoot现有Logback依赖</h3><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre><h3 id="加入Log4J2-的依赖"><a href="#加入Log4J2-的依赖" class="headerlink" title="加入Log4J2 的依赖"></a>加入Log4J2 的依赖</h3><pre><code class="hljs apache"><span class="hljs-section">&lt;dependency&gt;</span>    <span class="hljs-section">&lt;groupId&gt;</span><span class="hljs-attribute">org</span>.springframework.boot&lt;/groupId&gt;    <span class="hljs-section">&lt;artifactId&gt;</span><span class="hljs-attribute">spring</span>-boot-starter-log<span class="hljs-number">4</span>j<span class="hljs-number">2</span>&lt;/artifactId&gt;<span class="hljs-section">&lt;/dependency&gt;</span></code></pre><h3 id="配置application-yml-配置文件"><a href="#配置application-yml-配置文件" class="headerlink" title="配置application.yml 配置文件"></a>配置application.yml 配置文件</h3><pre><code class="hljs less"><span class="hljs-attribute">logging</span>:    <span class="hljs-attribute">config</span>: <span class="hljs-attribute">classpath</span>: config/log4j2-dev.xml</code></pre><h3 id="log4j2-dev-xml-根据官方文档进行配置"><a href="#log4j2-dev-xml-根据官方文档进行配置" class="headerlink" title="log4j2-dev.xml 根据官方文档进行配置"></a>log4j2-dev.xml 根据官方文档进行配置</h3><p>地址： <a href="https://logging.apache.org/log4j/2.x/manual/layouts.html">https://logging.apache.org/log4j/2.x/manual/layouts.html</a></p><p>推荐配置：(网络上找到的不错的配置)</p><pre><code class="hljs dust"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Configuration</span> <span class="hljs-attr">status</span>=<span class="hljs-string">&quot;INFO&quot;</span> <span class="hljs-attr">monitorInterval</span>=<span class="hljs-string">&quot;30&quot;</span>&gt;</span></span><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Properties</span>&gt;</span></span><span class="xml">        <span class="hljs-comment">&lt;!--  输出路径  --&gt;</span></span><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">Property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;logpath&quot;</span>&gt;</span>/Log4j/logs/log/dev<span class="hljs-tag">&lt;/<span class="hljs-name">Property</span>&gt;</span></span><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">Properties</span>&gt;</span></span><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Appenders</span>&gt;</span></span><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">Console</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;Console&quot;</span> <span class="hljs-attr">target</span>=<span class="hljs-string">&quot;SYSTEM_OUT&quot;</span>&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">PatternLayout</span></span></span><span class="xml">                    pattern=&quot;[%d][%-5p][%t] %m (%F:%L)%n&quot;/&gt;</span><span class="xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">Console</span>&gt;</span></span><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">RollingFile</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;debug&quot;</span> <span class="hljs-attr">fileName</span>=<span class="hljs-string">&quot;$</span></span></span><span class="hljs-template-variable">&#123;logpath&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">/debug/erp_debug.log&quot;</span></span></span><span class="xml">                     filePattern=&quot;$</span><span class="hljs-template-variable">&#123;logpath&#125;</span><span class="xml">/debug/erp_debug_%d</span><span class="hljs-template-variable">&#123;yyyy-MM-dd&#125;</span><span class="xml">-%i.log&quot;&gt;</span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">Filters</span>&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ThresholdFilter</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;info&quot;</span> <span class="hljs-attr">onMatch</span>=<span class="hljs-string">&quot;DENY&quot;</span> <span class="hljs-attr">onMismatch</span>=<span class="hljs-string">&quot;NEUTRAL&quot;</span>/&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ThresholdFilter</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;debug&quot;</span> <span class="hljs-attr">onMatch</span>=<span class="hljs-string">&quot;ACCEPT&quot;</span> <span class="hljs-attr">onMismatch</span>=<span class="hljs-string">&quot;DENY&quot;</span>/&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">Filters</span>&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">PatternLayout</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;[%d][%-5p][%t] %m (%F:%L)%n&quot;</span>/&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">Policies</span>&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">TimeBasedTriggeringPolicy</span> <span class="hljs-attr">interval</span>=<span class="hljs-string">&quot;24&quot;</span> <span class="hljs-attr">modulate</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">SizeBasedTriggeringPolicy</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;50 MB&quot;</span>/&gt;</span>\</span><span class="xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">Policies</span>&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">DefaultRolloverStrategy</span> <span class="hljs-attr">max</span>=<span class="hljs-string">&quot;30&quot;</span>&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">Delete</span> <span class="hljs-attr">basePath</span>=<span class="hljs-string">&quot;$</span></span></span><span class="hljs-template-variable">&#123;logpath&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">/debug&quot;</span> <span class="hljs-attr">maxDepth</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span></span><span class="xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">IfFileName</span> <span class="hljs-attr">glob</span>=<span class="hljs-string">&quot;erp_debug_*.log&quot;</span>/&gt;</span></span><span class="xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">IfLastModified</span> <span class="hljs-attr">age</span>=<span class="hljs-string">&quot;15d&quot;</span>/&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">Delete</span>&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">DefaultRolloverStrategy</span>&gt;</span></span><span class="xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">RollingFile</span>&gt;</span></span><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">RollingFile</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;info&quot;</span> <span class="hljs-attr">fileName</span>=<span class="hljs-string">&quot;$</span></span></span><span class="hljs-template-variable">&#123;logpath&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">/info/erp_info.log&quot;</span></span></span><span class="xml">                     filePattern=&quot;$</span><span class="hljs-template-variable">&#123;logpath&#125;</span><span class="xml">/info/erp_info_%d</span><span class="hljs-template-variable">&#123;yyyy-MM-dd&#125;</span><span class="xml">-%i.log&quot;&gt;</span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">Filters</span>&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ThresholdFilter</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;warn&quot;</span> <span class="hljs-attr">onMatch</span>=<span class="hljs-string">&quot;DENY&quot;</span> <span class="hljs-attr">onMismatch</span>=<span class="hljs-string">&quot;NEUTRAL&quot;</span>/&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ThresholdFilter</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;info&quot;</span> <span class="hljs-attr">onMatch</span>=<span class="hljs-string">&quot;ACCEPT&quot;</span> <span class="hljs-attr">onMismatch</span>=<span class="hljs-string">&quot;DENY&quot;</span>/&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">Filters</span>&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">PatternLayout</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;[%d][%-5p][%t] %m (%F:%L)%n&quot;</span>/&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">Policies</span>&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">TimeBasedTriggeringPolicy</span> <span class="hljs-attr">interval</span>=<span class="hljs-string">&quot;24&quot;</span> <span class="hljs-attr">modulate</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">SizeBasedTriggeringPolicy</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;50 MB&quot;</span>/&gt;</span>\</span><span class="xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">Policies</span>&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">DefaultRolloverStrategy</span> <span class="hljs-attr">max</span>=<span class="hljs-string">&quot;30&quot;</span>&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">Delete</span> <span class="hljs-attr">basePath</span>=<span class="hljs-string">&quot;$</span></span></span><span class="hljs-template-variable">&#123;logpath&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">/info&quot;</span> <span class="hljs-attr">maxDepth</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span></span><span class="xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">IfFileName</span> <span class="hljs-attr">glob</span>=<span class="hljs-string">&quot;erp_info_*.log&quot;</span>/&gt;</span></span><span class="xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">IfLastModified</span> <span class="hljs-attr">age</span>=<span class="hljs-string">&quot;15d&quot;</span>/&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">Delete</span>&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">DefaultRolloverStrategy</span>&gt;</span></span><span class="xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">RollingFile</span>&gt;</span></span><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">RollingFile</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;warn&quot;</span> <span class="hljs-attr">fileName</span>=<span class="hljs-string">&quot;$</span></span></span><span class="hljs-template-variable">&#123;logpath&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">/warn/erp_warn.log&quot;</span></span></span><span class="xml">                     filePattern=&quot;$</span><span class="hljs-template-variable">&#123;logpath&#125;</span><span class="xml">/warn/erp_warn_%d</span><span class="hljs-template-variable">&#123;yyyy-MM-dd&#125;</span><span class="xml">-%i.log&quot;&gt;</span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">Filters</span>&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ThresholdFilter</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;error&quot;</span> <span class="hljs-attr">onMatch</span>=<span class="hljs-string">&quot;DENY&quot;</span> <span class="hljs-attr">onMismatch</span>=<span class="hljs-string">&quot;NEUTRAL&quot;</span>/&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ThresholdFilter</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;warn&quot;</span> <span class="hljs-attr">onMatch</span>=<span class="hljs-string">&quot;ACCEPT&quot;</span> <span class="hljs-attr">onMismatch</span>=<span class="hljs-string">&quot;DENY&quot;</span>/&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">Filters</span>&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">PatternLayout</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;[%d][%-5p][%t] %m (%F:%L)%n&quot;</span>/&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">Policies</span>&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">TimeBasedTriggeringPolicy</span> <span class="hljs-attr">interval</span>=<span class="hljs-string">&quot;24&quot;</span> <span class="hljs-attr">modulate</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">SizeBasedTriggeringPolicy</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;50 MB&quot;</span>/&gt;</span>\</span><span class="xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">Policies</span>&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">DefaultRolloverStrategy</span> <span class="hljs-attr">max</span>=<span class="hljs-string">&quot;30&quot;</span>&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">Delete</span> <span class="hljs-attr">basePath</span>=<span class="hljs-string">&quot;$</span></span></span><span class="hljs-template-variable">&#123;logpath&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">/warn&quot;</span> <span class="hljs-attr">maxDepth</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span></span><span class="xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">IfFileName</span> <span class="hljs-attr">glob</span>=<span class="hljs-string">&quot;erp_warn_*.log&quot;</span>/&gt;</span></span><span class="xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">IfLastModified</span> <span class="hljs-attr">age</span>=<span class="hljs-string">&quot;15d&quot;</span>/&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">Delete</span>&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">DefaultRolloverStrategy</span>&gt;</span></span><span class="xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">RollingFile</span>&gt;</span></span><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">RollingFile</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;error&quot;</span> <span class="hljs-attr">fileName</span>=<span class="hljs-string">&quot;$</span></span></span><span class="hljs-template-variable">&#123;logpath&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">/error/erp_error.log&quot;</span></span></span><span class="xml">                     filePattern=&quot;$</span><span class="hljs-template-variable">&#123;logpath&#125;</span><span class="xml">/error/erp_error_%d</span><span class="hljs-template-variable">&#123;yyyy-MM-dd&#125;</span><span class="xml">-%i.log&quot;&gt;</span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">Filters</span>&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ThresholdFilter</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;fatal&quot;</span> <span class="hljs-attr">onMatch</span>=<span class="hljs-string">&quot;DENY&quot;</span> <span class="hljs-attr">onMismatch</span>=<span class="hljs-string">&quot;NEUTRAL&quot;</span>/&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ThresholdFilter</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;error&quot;</span> <span class="hljs-attr">onMatch</span>=<span class="hljs-string">&quot;ACCEPT&quot;</span> <span class="hljs-attr">onMismatch</span>=<span class="hljs-string">&quot;DENY&quot;</span>/&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">Filters</span>&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">PatternLayout</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;[%d][%-5p][%t] %m (%F:%L)%n&quot;</span>/&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">Policies</span>&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">TimeBasedTriggeringPolicy</span> <span class="hljs-attr">interval</span>=<span class="hljs-string">&quot;24&quot;</span> <span class="hljs-attr">modulate</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span></span><span class="xml">                  <span class="hljs-comment">&lt;!--   每个文件最大50M --&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">SizeBasedTriggeringPolicy</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;50 MB&quot;</span>/&gt;</span>\</span><span class="xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">Policies</span>&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">DefaultRolloverStrategy</span> <span class="hljs-attr">max</span>=<span class="hljs-string">&quot;30&quot;</span>&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;<span class="hljs-name">Delete</span> <span class="hljs-attr">basePath</span>=<span class="hljs-string">&quot;$</span></span></span><span class="hljs-template-variable">&#123;logpath&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">/error&quot;</span> <span class="hljs-attr">maxDepth</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span></span><span class="xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">IfFileName</span> <span class="hljs-attr">glob</span>=<span class="hljs-string">&quot;erp_error_*.log&quot;</span>/&gt;</span></span><span class="xml">                     <span class="hljs-comment">&lt;!-- 设置最大保存时间为15天--&gt;</span></span><span class="xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">IfLastModified</span> <span class="hljs-attr">age</span>=<span class="hljs-string">&quot;15d&quot;</span>/&gt;</span></span><span class="xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">Delete</span>&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">DefaultRolloverStrategy</span>&gt;</span></span><span class="xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">RollingFile</span>&gt;</span></span><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">Appenders</span>&gt;</span></span><span class="xml">   <span class="hljs-comment">&lt;!--切换输出级别--&gt;</span></span><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Loggers</span>&gt;</span></span><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">Root</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;info&quot;</span>&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">AppenderRef</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;Console&quot;</span>/&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">AppenderRef</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;debug&quot;</span>/&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">AppenderRef</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;info&quot;</span>/&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">AppenderRef</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;warn&quot;</span>/&gt;</span></span><span class="xml">            <span class="hljs-tag">&lt;<span class="hljs-name">AppenderRef</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;error&quot;</span>/&gt;</span></span><span class="xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">Root</span>&gt;</span></span><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">Loggers</span>&gt;</span></span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">Configuration</span>&gt;</span></span></code></pre><h3 id="注意的地方"><a href="#注意的地方" class="headerlink" title="注意的地方"></a>注意的地方</h3><p>log4j2的配置文件是支持yml格式，但是如果使用yml格式的需要加入yml解析依赖包才能起作用，要不然有错误</p><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.fasterxml.jackson.dataformat<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jackson-dataformat-yaml<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre><blockquote><p>如果不加这个依赖，会有项目启动报错：Could not initialize Log4J2 logging from classpath:log4j2-dev.yml</p></blockquote><h3 id="SpringBoot配置文件中还可以加入打印级别指定"><a href="#SpringBoot配置文件中还可以加入打印级别指定" class="headerlink" title="SpringBoot配置文件中还可以加入打印级别指定"></a>SpringBoot配置文件中还可以加入打印级别指定</h3><pre><code class="hljs dts"><span class="hljs-symbol">logging:</span><span class="hljs-symbol">    level:</span>        org.springframework=INFO</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>SpringBoot,Logging,Log4J2,Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Docker compose 启动的容器设置开启自动启该容器</title>
    <link href="/2020/10/12/every_little_bit/docker/docker-compose-restart/"/>
    <url>/2020/10/12/every_little_bit/docker/docker-compose-restart/</url>
    
    <content type="html"><![CDATA[<h1 id="Docker-compose-启动的容器设置开启自动启该容器"><a href="#Docker-compose-启动的容器设置开启自动启该容器" class="headerlink" title="Docker compose 启动的容器设置开启自动启该容器"></a>Docker compose 启动的容器设置开启自动启该容器</h1><h3 id="在docker配置文件-docker-compose-yml-添加属性"><a href="#在docker配置文件-docker-compose-yml-添加属性" class="headerlink" title="在docker配置文件 docker-compose.yml 添加属性"></a>在docker配置文件 docker-compose.yml 添加属性</h3><pre><code class="hljs less"><span class="hljs-attribute">version</span>: <span class="hljs-string">&#x27;3.3&#x27;</span><span class="hljs-attribute">services</span>:<span class="hljs-attribute">web</span>:    <span class="hljs-attribute">image</span>: <span class="hljs-attribute">demo</span>:<span class="hljs-number">1.0</span>.<span class="hljs-number">0</span>    <span class="hljs-attribute">ports</span>:      - <span class="hljs-number">8000</span>:<span class="hljs-number">8000</span>    <span class="hljs-attribute">restart</span>: always</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>docker,docker compose,start,Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello Andot Studio</title>
    <link href="/2020/10/11/hello-andot/"/>
    <url>/2020/10/11/hello-andot/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://andot.org/">AndotStudio</a>! </p><h2 id="欢迎您们来到我的个人博客"><a href="#欢迎您们来到我的个人博客" class="headerlink" title="欢迎您们来到我的个人博客"></a>欢迎您们来到我的个人博客</h2><h3 id="知乎"><a href="#知乎" class="headerlink" title="知乎"></a>知乎</h3><blockquote><p>个人主页：<a href="https://www.zhihu.com/people/antsdot">https://www.zhihu.com/people/antsdot</a></p></blockquote><blockquote><p>知乎专栏：<a href="https://www.zhihu.com/column/artskill">https://www.zhihu.com/column/artskill</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Spring配置文件p冒号driverClass等元素错误</title>
    <link href="/2018/03/01/2018/springp/"/>
    <url>/2018/03/01/2018/springp/</url>
    
    <content type="html"><![CDATA[<h3 id="在Spring配置文件中配置数据源使用SpEL、p-driverClass等元素时不小心会出现下面错误"><a href="#在Spring配置文件中配置数据源使用SpEL、p-driverClass等元素时不小心会出现下面错误" class="headerlink" title="在Spring配置文件中配置数据源使用SpEL、p:driverClass等元素时不小心会出现下面错误"></a>在Spring配置文件中配置数据源使用SpEL、p:driverClass等元素时不小心会出现下面错误</h3><pre><code class="hljs django"><span class="xml">The prefix &quot;p&quot; for attribute &quot;p:jdbc.driverClassName&quot; associatedwith an element type &quot;bean&quot; is not bound</span><span class="xml">意思是: 前缀“p”属性“p:jdbc。driverClassName”与某个元素类型相关“bean”却不被捆绑</span><span class="xml"> </span><span class="xml">这是因为在使用XML Schema作为配置文件的语义约束时,没有添加下面这条语句</span><span class="xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot;encoding=&quot;UTF-8&quot;?&gt;</span> </span><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">beansxmlns=&quot;http:</span>//<span class="hljs-attr">www.springframework.org</span>/<span class="hljs-attr">schema</span>/<span class="hljs-attr">beans</span>&quot;<span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="hljs-attr">xmlns:tx</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/tx&quot;</span><span class="hljs-attr">xmlns:aop</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/aop&quot;</span><span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span><span class="hljs-attr">xmlns:jee</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/jee&quot;</span></span></span><span class="xml">**** 重要的一句****&gt;   xmlns:p=&quot;http://www.springframework.org/schema/p&quot;</span><span class="xml">  xsi:schemaLocation=&quot;http://www.springframework.org/schema/txhttp://www.springframework.org/schema/tx/spring-tx-3.2.xsdhttp://www.springframework.org/schema/aophttp://www.springframework.org/schema/aop/spring-aop-3.2.xsdhttp://www.springframework.org/schema/beanshttp://www.springframework.org/schema/beans/spring-beans-3.2.xsdhttp://www.springframework.org/schema/contexthttp://www.springframework.org/schema/context/spring-context-3.2.xsdhttp://www.springframework.org/schema/jeehttp://www.springframework.org/schema/jee/spring-jee-3.2.xsd&quot;&gt;</span><span class="xml"><span class="hljs-comment">&lt;!-- 使用c3p0配置数据源--&gt;</span> </span><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSource&quot;</span><span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;</span><span class="hljs-attr">destroy-method</span>=<span class="hljs-string">&quot;close&quot;</span><span class="hljs-attr">p:jdbc.driverClassName</span>=<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span></span></span><span class="xml"> p:jdbcUrl=&quot;jdbc:mysql://localhost:3306/hrSystem&quot;</span><span class="xml"> p:user=&quot;root&quot;</span><span class="xml"> p:password=&quot;mrxing&quot;</span><span class="xml"> p:maxPoolSize=&quot;40&quot;</span><span class="xml"> p:minPoolSize=&quot;1&quot; </span><span class="xml"> p:initialPoolSize=&quot;1&quot;</span><span class="xml"> p:maxIdleTime=&quot;20&quot;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span></span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></span></code></pre><html>    <h4 style="color:#F00;">XML Schema 中加入：xmlns:p="http://www.springframework.org/schema/p"</h4></html>]]></content>
    
    
    
    <tags>
      
      <tag>spring, p, &lt;p&gt;</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python利用urlib2传输一个超大的集合给Java后端</title>
    <link href="/2018/03/01/2018/pythontojava/"/>
    <url>/2018/03/01/2018/pythontojava/</url>
    
    <content type="html"><![CDATA[<h3 id="我们需求中需要传输的超大集合"><a href="#我们需求中需要传输的超大集合" class="headerlink" title="我们需求中需要传输的超大集合"></a>我们需求中需要传输的超大集合</h3><blockquote><p>集合长度为：492*6条</p></blockquote><pre><code class="hljs yaml"><span class="hljs-string">arr</span> <span class="hljs-string">=</span> [&#123;    <span class="hljs-attr">&quot;cityName&quot;:</span> <span class="hljs-string">&quot;北京&quot;</span>,    <span class="hljs-attr">&quot;temperature&quot;:</span> <span class="hljs-number">25</span>,     <span class="hljs-attr">&quot;humidity&quot;:</span> <span class="hljs-number">23</span>,    <span class="hljs-attr">&quot;population&quot;:</span> <span class="hljs-number">23</span>,    <span class="hljs-attr">&quot;english&quot;:</span> <span class="hljs-string">&quot;beijing&quot;</span>&#125;, &#123;    <span class="hljs-attr">&quot;cityName&quot;:</span> <span class="hljs-string">&quot;山东省&quot;</span>,    <span class="hljs-attr">&quot;temperature&quot;:</span> <span class="hljs-number">25</span>,     <span class="hljs-attr">&quot;humidity&quot;:</span> <span class="hljs-number">23</span>,    <span class="hljs-attr">&quot;population&quot;:</span> <span class="hljs-number">23</span>,    <span class="hljs-attr">&quot;english&quot;:</span> <span class="hljs-string">&quot;shandong&quot;</span>&#125;, &#123;    <span class="hljs-attr">&quot;cityName&quot;:</span> <span class="hljs-string">&quot;上海&quot;</span>,    <span class="hljs-attr">&quot;temperature&quot;:</span> <span class="hljs-number">25</span>,     <span class="hljs-attr">&quot;humidity&quot;:</span> <span class="hljs-number">23</span>,    <span class="hljs-attr">&quot;population&quot;:</span> <span class="hljs-number">23</span>,    <span class="hljs-attr">&quot;english&quot;:</span> <span class="hljs-string">&quot;shanghai&quot;</span>&#125;, <span class="hljs-string">...</span>]</code></pre><h3 id="Python通过POST发送集合"><a href="#Python通过POST发送集合" class="headerlink" title="Python通过POST发送集合"></a>Python通过POST发送集合</h3><blockquote><p>集合传输只能依靠于JSON字符串传输，这里就需要非常的注意了</p></blockquote><ol><li>集合转为JSON字符串，中文按照UTF-8编码</li></ol><pre><code class="hljs ini"><span class="hljs-attr">strs</span> = json.dumps(result, ensure_ascii=<span class="hljs-literal">False</span>, encoding=<span class="hljs-string">&#x27;UTF-8&#x27;</span>)<span class="hljs-attr">params</span> = urllib.urlencode(&#123;<span class="hljs-string">&quot;saveList&quot;</span>: strs&#125;)</code></pre><ol start="2"><li>发送POST请求，get请求不合适，也不能传输大文本</li></ol><pre><code class="hljs routeros"><span class="hljs-comment"># 定义一些文件头</span>headers = &#123;<span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/x-www-form-urlencoded&quot;</span>, <span class="hljs-string">&quot;Connection&quot;</span>: <span class="hljs-string">&quot;Keep-Alive&quot;</span>,           <span class="hljs-string">&quot;Referer&quot;</span>: <span class="hljs-string">&#x27;http://127.0.0.1:8080/test&#x27;</span>&#125;;<span class="hljs-comment"># 与网站构建一个连接</span>conn = httplib.HTTPConnection(<span class="hljs-string">&quot;127.0.0.1&quot;</span>, 8080);<span class="hljs-comment"># 开始进行数据提交，同时也可以使用get进行</span>conn.request(<span class="hljs-attribute">method</span>=<span class="hljs-string">&quot;POST&quot;</span>, <span class="hljs-attribute">url</span>=<span class="hljs-string">&quot;/test&quot;</span>, <span class="hljs-attribute">body</span>=params, <span class="hljs-attribute">headers</span>=headers);<span class="hljs-comment"># 返回处理后的数据</span>response = conn.getresponse();<span class="hljs-comment"># 判断是否提交成功</span><span class="hljs-keyword">if</span> response.status == 200:    print<span class="hljs-string">&quot;发布成功!^_^!&quot;</span>;<span class="hljs-keyword">else</span>:    print<span class="hljs-string">&quot;发布失败\^0^/&quot;</span>;<span class="hljs-comment"># 关闭连接</span>conn.close();strs = json.dumps(result, <span class="hljs-attribute">ensure_ascii</span>=<span class="hljs-literal">False</span>, <span class="hljs-attribute">encoding</span>=<span class="hljs-string">&#x27;UTF-8&#x27;</span>)params = urllib.urlencode(&#123;<span class="hljs-string">&quot;saveList&quot;</span>: strs&#125;)</code></pre><h3 id="这样传输，既可以解决传输大量数据，也可以传输中文，java直接接受到字符串，也不需要转码，转成JSON字符串，就可以循环遍历存储数据库了"><a href="#这样传输，既可以解决传输大量数据，也可以传输中文，java直接接受到字符串，也不需要转码，转成JSON字符串，就可以循环遍历存储数据库了" class="headerlink" title="这样传输，既可以解决传输大量数据，也可以传输中文，java直接接受到字符串，也不需要转码，转成JSON字符串，就可以循环遍历存储数据库了"></a>这样传输，既可以解决传输大量数据，也可以传输中文，java直接接受到字符串，也不需要转码，转成JSON字符串，就可以循环遍历存储数据库了</h3><pre><code class="hljs reasonml">   @<span class="hljs-constructor">RequestMapping(<span class="hljs-params">value</span>=<span class="hljs-string">&quot;/test&quot;</span>, <span class="hljs-params">produces</span>=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span>)</span>@ResponseBodypublic String get<span class="hljs-constructor">WeatherList(HttpServletRequest <span class="hljs-params">request</span>)</span>&#123;    String json = request.get<span class="hljs-constructor">Parameter(<span class="hljs-string">&quot;saveList&quot;</span>)</span>;    JSONArray jsonArray = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">JSONArray</span>.</span></span>from<span class="hljs-constructor">Object(<span class="hljs-params">json</span>)</span>;       Object<span class="hljs-literal">[]</span> os = jsonArray .<span class="hljs-keyword">to</span><span class="hljs-constructor">Array()</span>;       <span class="hljs-keyword">for</span>(<span class="hljs-built_in">int</span> i=<span class="hljs-number">0</span>; i&lt;os.length; i++) &#123;           JSONObject jsonObj = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">JSONObject</span>.</span></span>from<span class="hljs-constructor">Object(<span class="hljs-params">os</span>[<span class="hljs-params">i</span>])</span>;           <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">System</span>.</span></span>out.println(jsonObj.get(<span class="hljs-string">&quot;cityName&quot;</span>));       &#125;&#125;</code></pre><blockquote><p>打印结果: 上海</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>python, java, urlib2, json, list</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用druid连接池的超时回收机制排查连接泄露问题</title>
    <link href="/2018/03/01/2018/druidremove/"/>
    <url>/2018/03/01/2018/druidremove/</url>
    
    <content type="html"><![CDATA[<h3 id="在工程中使用了druid连接池，运行一段时间后系统出现异常："><a href="#在工程中使用了druid连接池，运行一段时间后系统出现异常：" class="headerlink" title="在工程中使用了druid连接池，运行一段时间后系统出现异常："></a>在工程中使用了druid连接池，运行一段时间后系统出现异常：</h3><pre><code class="hljs base">Caused by: org.springframework.jdbc.CannotGetJdbcConnectionException: Could not get JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 60009, active 50                  at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:80)                  at org.springframework.jdbc.support.JdbcUtils.extractDatabaseMetaData(JdbcUtils.java:280)                  ... 64 more  Caused by: com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 60000, active 50                  at com.alibaba.druid.pool.DruidDataSource.getConnectionInternal(DruidDataSource.java:1071)                  at com.alibaba.druid.pool.DruidDataSource.getConnectionDirect(DruidDataSource.java:898)                  at com.alibaba.druid.filter.FilterChainImpl.dataSource_connect(FilterChainImpl.java:4544)</code></pre><blockquote><p>mysql数据库最大连接数设置为500，使用客户端能正常连接。连接数被未被占满。</p></blockquote><h3 id="分析原因应该是程序中有地方连接未关闭造成的。那如何来定呢？使用druid连接池的超时回收机制，在配置中增加以下内容："><a href="#分析原因应该是程序中有地方连接未关闭造成的。那如何来定呢？使用druid连接池的超时回收机制，在配置中增加以下内容：" class="headerlink" title="分析原因应该是程序中有地方连接未关闭造成的。那如何来定呢？使用druid连接池的超时回收机制，在配置中增加以下内容："></a>分析原因应该是程序中有地方连接未关闭造成的。那如何来定呢？使用druid连接池的超时回收机制，在配置中增加以下内容：</h3><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 超过时间限制是否回收 --&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;removeAbandoned&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span>  <span class="hljs-comment">&lt;!-- 超时时间；单位为秒。180秒=3分钟 --&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;removeAbandonedTimeout&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;180&quot;</span> /&gt;</span>  <span class="hljs-comment">&lt;!-- 关闭abanded连接时输出错误日志 --&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;logAbandoned&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span></code></pre><h3 id="运行程序，当连接超过3分钟后会强制进行回收，并输出异常日志。"><a href="#运行程序，当连接超过3分钟后会强制进行回收，并输出异常日志。" class="headerlink" title="运行程序，当连接超过3分钟后会强制进行回收，并输出异常日志。"></a>运行程序，当连接超过3分钟后会强制进行回收，并输出异常日志。</h3><pre><code class="hljs stylus"><span class="hljs-number">2014</span>-<span class="hljs-number">10</span>-<span class="hljs-number">13</span> <span class="hljs-number">16</span>:<span class="hljs-number">02</span>:<span class="hljs-number">28</span>,<span class="hljs-number">919</span> ERROR [com<span class="hljs-selector-class">.alibaba</span><span class="hljs-selector-class">.druid</span><span class="hljs-selector-class">.pool</span>.DruidDataSource] - &lt;abandon connection, open stackTrace          at java<span class="hljs-selector-class">.lang</span><span class="hljs-selector-class">.Thread</span>.getStackTrace(Thread<span class="hljs-selector-class">.java</span>:<span class="hljs-number">1567</span>)          at com<span class="hljs-selector-class">.alibaba</span><span class="hljs-selector-class">.druid</span><span class="hljs-selector-class">.pool</span><span class="hljs-selector-class">.DruidDataSource</span>.getConnectionDirect(DruidDataSource<span class="hljs-selector-class">.java</span>:<span class="hljs-number">995</span>)          at com<span class="hljs-selector-class">.alibaba</span><span class="hljs-selector-class">.druid</span><span class="hljs-selector-class">.filter</span><span class="hljs-selector-class">.FilterChainImpl</span>.dataSource_connect(FilterChainImpl<span class="hljs-selector-class">.java</span>:<span class="hljs-number">4544</span>)          at com<span class="hljs-selector-class">.alibaba</span><span class="hljs-selector-class">.druid</span><span class="hljs-selector-class">.filter</span><span class="hljs-selector-class">.stat</span><span class="hljs-selector-class">.StatFilter</span>.dataSource_getConnection(StatFilter<span class="hljs-selector-class">.java</span>:<span class="hljs-number">661</span>)          at com<span class="hljs-selector-class">.alibaba</span><span class="hljs-selector-class">.druid</span><span class="hljs-selector-class">.filter</span><span class="hljs-selector-class">.FilterChainImpl</span>.dataSource_connect(FilterChainImpl<span class="hljs-selector-class">.java</span>:<span class="hljs-number">4540</span>)          at com<span class="hljs-selector-class">.alibaba</span><span class="hljs-selector-class">.druid</span><span class="hljs-selector-class">.pool</span><span class="hljs-selector-class">.DruidDataSource</span>.getConnection(DruidDataSource<span class="hljs-selector-class">.java</span>:<span class="hljs-number">919</span>)          at com<span class="hljs-selector-class">.alibaba</span><span class="hljs-selector-class">.druid</span><span class="hljs-selector-class">.pool</span><span class="hljs-selector-class">.DruidDataSource</span>.getConnection(DruidDataSource<span class="hljs-selector-class">.java</span>:<span class="hljs-number">911</span>)          at com<span class="hljs-selector-class">.alibaba</span><span class="hljs-selector-class">.druid</span><span class="hljs-selector-class">.pool</span><span class="hljs-selector-class">.DruidDataSource</span>.getConnection(DruidDataSource<span class="hljs-selector-class">.java</span>:<span class="hljs-number">98</span>)                    at cn<span class="hljs-selector-class">.org</span><span class="hljs-selector-class">.xxx</span><span class="hljs-selector-class">.xxx</span><span class="hljs-selector-class">.xxx</span><span class="hljs-selector-class">.PaginationInterceptor</span>.intercept(PaginationInterceptor<span class="hljs-selector-class">.java</span>:<span class="hljs-number">96</span>)                    at org<span class="hljs-selector-class">.apache</span><span class="hljs-selector-class">.ibatis</span><span class="hljs-selector-class">.plugin</span><span class="hljs-selector-class">.Plugin</span>.invoke(Plugin<span class="hljs-selector-class">.java</span>:<span class="hljs-number">60</span>)          at com<span class="hljs-selector-class">.sun</span><span class="hljs-selector-class">.proxy</span>.<span class="hljs-variable">$Proxy59</span>.query(Unknown Source)          at org<span class="hljs-selector-class">.apache</span><span class="hljs-selector-class">.ibatis</span><span class="hljs-selector-class">.session</span><span class="hljs-selector-class">.defaults</span><span class="hljs-selector-class">.DefaultSqlSession</span>.selectList(DefaultSqlSession<span class="hljs-selector-class">.java</span>:<span class="hljs-number">108</span>)</code></pre><blockquote><p>很清楚地看到是在哪里打开的连接未关闭一直在占有。</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>druid, springboot, java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java中 VO、 PO、DO、DTO、 BO、 QO、DAO、POJO的概念</title>
    <link href="/2018/02/23/2018/java-package-base-info/"/>
    <url>/2018/02/23/2018/java-package-base-info/</url>
    
    <content type="html"><![CDATA[<h3 id="PO-persistant-object-持久对象"><a href="#PO-persistant-object-持久对象" class="headerlink" title="PO(persistant object) 持久对象"></a>PO(persistant object) 持久对象</h3><blockquote><p>在 o/r 映射的时候出现的概念，如果没有 o/r 映射，没有这个概念存在了。通常对应数据模型 ( 数据库 ), 本身还有部分业务逻辑的处理。可以看成是与数据库中的表相映射的 java 对象。最简单的 PO 就是对应数据库中某个表中的一条记录，多个记录可以用 PO 的集合。 PO 中应该不包含任何对数据库的操作。</p></blockquote><h3 id="DO（Domain-Object）领域对象"><a href="#DO（Domain-Object）领域对象" class="headerlink" title="DO（Domain Object）领域对象"></a>DO（Domain Object）领域对象</h3><blockquote><p>就是从现实世界中抽象出来的有形或无形的业务实体。一般和数据中的表结构对应。</p></blockquote><h3 id="TO-Transfer-Object-，数据传输对象"><a href="#TO-Transfer-Object-，数据传输对象" class="headerlink" title="TO(Transfer Object) ，数据传输对象"></a>TO(Transfer Object) ，数据传输对象</h3><blockquote><p>在应用程序不同 tie( 关系 ) 之间传输的对象</p></blockquote><h3 id="DTO（Data-Transfer-Object）数据传输对象"><a href="#DTO（Data-Transfer-Object）数据传输对象" class="headerlink" title="DTO（Data Transfer Object）数据传输对象"></a>DTO（Data Transfer Object）数据传输对象</h3><blockquote><p>这个概念来源于J2EE的设计模式，原来的目的是为了EJB的分布式应用提供粗粒度的数据实体，以减少分布式调用的次数，从而提高分布式调用的性能和降低网络负载，但在这里，我泛指用于展示层与服务层之间的数据传输对象。</p></blockquote><blockquote><p>主要用于远程调用等需要大量传输对象的地方。<br>比如我们一张表有100个字段，那么对应的PO就有100个属性。<br>但是我们界面上只要显示10个字段，<br>客户端用WEB service来获取数据，没有必要把整个PO对象传递到客户端，<br>这时我们就可以用只有这10个属性的DTO来传递结果到客户端，这样也不会暴露服务端表结构.到达客户端以后，如果用这个对象来对应界面显示，那此时它的身份就转为VO</p></blockquote><h3 id="VO-view-object-值对象"><a href="#VO-view-object-值对象" class="headerlink" title="VO(view object) 值对象"></a>VO(view object) 值对象</h3><blockquote><p> 视图对象，用于展示层，它的作用是把某个指定页面（或组件）的所有数据封装起来。</p></blockquote><blockquote><p>通常用于业务层之间的数据传递,和PO一样也是仅仅包含数据而已.但应是抽象出的业务对象,可以和表对应,也可以不,这根据业务的需要.个人觉得同DTO(数据传输对象),在web上传递.</p></blockquote><h3 id="BO-business-object-业务对象"><a href="#BO-business-object-业务对象" class="headerlink" title="BO(business object) 业务对象"></a>BO(business object) 业务对象</h3><blockquote><p>从业务模型的角度看 , 见 UML 元件领域模型中的领域对象。封装业务逻辑的 java 对象 , 通过调用 DAO 方法 , 结合 PO,VO 进行业务操作。 business object: 业务对象 主要作用是把业务逻辑封装为一个对象。这个对象可以包括一个或多个其它的对象。 比如一个简历，有教育经历、工作经历、社会关系等等。 我们可以把教育经历对应一个 PO ，工作经历对应一个 PO ，社会关系对应一个 PO 。 建立一个对应简历的 BO 对象处理简历，每个 BO 包含这些 PO 。 这样处理业务逻辑时，我们就可以针对 BO 去处理。</p></blockquote><h3 id="POJO-plain-ordinary-java-object-简单无规则-java-对象"><a href="#POJO-plain-ordinary-java-object-简单无规则-java-对象" class="headerlink" title="POJO(plain ordinary java object) 简单无规则 java 对象"></a>POJO(plain ordinary java object) 简单无规则 java 对象</h3><blockquote><p>纯的传统意义的 java 对象。就是说在一些 Object/Relation Mapping 工具中，能够做到维护数据库表记录的 persisent object 完全是一个符合 Java Bean 规范的纯 Java 对象，没有增加别的属性和方法。我的理解就是最基本的 Java Bean ，只有属性字段及 setter 和 getter 方法！。</p></blockquote><h3 id="DAO-data-access-object-数据访问对象"><a href="#DAO-data-access-object-数据访问对象" class="headerlink" title="DAO(data access object) 数据访问对象"></a>DAO(data access object) 数据访问对象</h3><blockquote><p>是一个 sun 的一个标准 j2ee 设计模式， 这个模式中有个接口就是 DAO ，它负持久层的操作。为业务层提供接口。此对象用于访问数据库。通常和 PO 结合使用， DAO 中包含了各种数据库的操作方法。通过它的方法 , 结合 PO 对数据库进行相关的操作。夹在业务逻辑与数据库资源中间。配合 VO, 提供数据库的 CRUD 操作</p></blockquote><h3 id="O-R-Mapper-对象-关系-映射"><a href="#O-R-Mapper-对象-关系-映射" class="headerlink" title="O/R Mapper 对象/关系 映射"></a>O/R Mapper 对象/关系 映射</h3><blockquote><p>定义好所有的mapping之后,这个O/R Mapper可以帮我们做很多的工作.通过这些mappings,这个O/R Mapper可以生成所有的关于对象保存,删除,读取的SQL语句,我们不再需要写那么多行的DAL代码了.</p></blockquote><blockquote><p>实体Model(实体模式)</p></blockquote><blockquote><p>DAL(数据访问层)</p></blockquote><blockquote><p>IDAL(接口层)</p></blockquote><blockquote><p>DALFactory(类工厂)</p></blockquote><blockquote><p>BLL(业务逻辑层)</p></blockquote><blockquote><p>BOF    Business Object Framework      业务对象框架</p></blockquote><blockquote><p>SOA    Service Orient Architecture    面向服务的设计</p></blockquote><blockquote><p>EMF    Eclipse Model Framework        Eclipse建模框架</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>Java, package</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java自定义注解学习写一个小例子</title>
    <link href="/2018/02/22/2018/java-custom-annotation-study/"/>
    <url>/2018/02/22/2018/java-custom-annotation-study/</url>
    
    <content type="html"><![CDATA[<h1 id="Java自定义注解书写例子学习"><a href="#Java自定义注解书写例子学习" class="headerlink" title="Java自定义注解书写例子学习"></a>Java自定义注解书写例子学习</h1><h2 id="1、先新建一个注解TestC"><a href="#1、先新建一个注解TestC" class="headerlink" title="1、先新建一个注解TestC"></a>1、先新建一个注解TestC</h2><pre><code class="hljs base">@Target(&#123; ElementType.TYPE, ElementType.METHOD &#125;)   &#x2F;&#x2F;说明次注解可以作用于类和方法@Retention(RetentionPolicy.RUNTIME)  &#x2F;&#x2F;说明此类是从JVM运行开始使用public @interface TestC &#123;&#x2F;** * 获取被注解方法的参数 *  * *&#x2F;String value() default &quot;&quot;;    &#x2F;&#x2F;方法名称自己定义，返回值根据需要&#125;</code></pre><h2 id="2、然后新建一个AOP拦截器进行拦截注解和备注解的方法"><a href="#2、然后新建一个AOP拦截器进行拦截注解和备注解的方法" class="headerlink" title="2、然后新建一个AOP拦截器进行拦截注解和备注解的方法"></a>2、然后新建一个AOP拦截器进行拦截注解和备注解的方法</h2><pre><code class="hljs base">@Aspect@Componentpublic class ParamInterception &#123;@Pointcut(&quot;execution(* cn.zup.*.service.*.*(..)) &amp;&amp; @annotation(cn.zup.framework.aop.TestC)&quot;)private void anyMethod()&#123;&#125;@Before(value&#x3D;&quot;anyMethod()&quot;)public void before(JoinPoint joinPoint)&#123;System.err.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);Signature signature &#x3D; joinPoint.getSignature();        MethodSignature methodSignature &#x3D; (MethodSignature) signature;        Method method &#x3D; methodSignature.getMethod();        System.err.println(method.getName());        Class&lt;?&gt; c &#x3D; joinPoint.getClass();&#x2F;&#x2F; 获取类中的所有定义字段            Field[] fields &#x3D; c.getDeclaredFields();        &#x2F;&#x2F; 循环遍历字段，获取字段对应的属性值            for (Field field : fields) &#123;                &#x2F;&#x2F; 如果不为空，设置可见性，然后返回                field.setAccessible(true);             try &#123;                    &#x2F;&#x2F; 设置字段可见，即可用get方法获取属性值。                if(field.get(joinPoint) !&#x3D; null)&#123;            System.err.println(field.getName() + &quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot; + field.get(joinPoint));            &#125;            &#125; catch (Exception e) &#123;                System.err.println(&quot;error--------&quot;+this.getClass().getMethods()+&quot;.Reason is:&quot;+e.getMessage());                &#125;            &#125;           &#125;&#125;</code></pre><h2 id="在方法上进行添加注解"><a href="#在方法上进行添加注解" class="headerlink" title="在方法上进行添加注解"></a>在方法上进行添加注解</h2><pre><code class="hljs oxygene">@TestC<span class="hljs-keyword">public</span> String <span class="hljs-function"><span class="hljs-keyword">method</span><span class="hljs-params">()</span><span class="hljs-comment">&#123;</span></span><span class="hljs-function"><span class="hljs-comment">    //TODO IS CODING</span></span><span class="hljs-function"><span class="hljs-comment">&#125;</span></span></code></pre><blockquote><p>以上就是一个最简单的注解的写法</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>java, annotation</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>andot-blog-open-source-by-github</title>
    <link href="/2018/02/21/2018/andot-blog-open-source-by-github/"/>
    <url>/2018/02/21/2018/andot-blog-open-source-by-github/</url>
    
    <content type="html"><![CDATA[<h2 id="andot-blog-蚁点博客开放源代码"><a href="#andot-blog-蚁点博客开放源代码" class="headerlink" title="andot blog 蚁点博客开放源代码"></a>andot blog 蚁点博客开放源代码</h2><h4 id="源代码已经上传到github，点击此链接下载"><a href="#源代码已经上传到github，点击此链接下载" class="headerlink" title="源代码已经上传到github，点击此链接下载"></a>源代码已经上传到github，点击此链接下载</h4><blockquote><p>git同步地址： <a href="https://github.com/andotorg/andotorg_source.git">https://github.com/andotorg/andotorg_source.git</a></p></blockquote><p><a href="https://github.com/andotorg/andotorg_source" title="蚁点博客源代码">蚁点博客源代码</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>github, andot, blog, hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ShiroVSSpringSecurity</title>
    <link href="/2018/02/21/2018/ShiroVSSpringSecurity/"/>
    <url>/2018/02/21/2018/ShiroVSSpringSecurity/</url>
    
    <content type="html"><![CDATA[<h2 id="Shiro"><a href="#Shiro" class="headerlink" title="Shiro"></a>Shiro</h2><blockquote><p>首先Shiro较之 Spring Security，Shiro在保持强大功能的同时，还在简单性和灵活性方面拥有巨大优势。</p></blockquote><blockquote><p>Shiro是一个强大而灵活的开源安全框架，能够非常清晰的处理认证、授权、管理会话以及密码加密。如下是它所具有的特点：</p></blockquote><ol><li>易于理解的 Java Security API；</li><li>简单的身份认证（登录），支持多种数据源（LDAP，JDBC，Kerberos，ActiveDirectory 等）；</li><li>对角色的简单的签权（访问控制），支持细粒度的签权；</li><li>支持一级缓存，以提升应用程序的性能；</li><li>内置的基于 POJO 企业会话管理，适用于 Web 以及非 Web 的环境；</li><li>异构客户端会话访问；</li><li>非常简单的加密 API；</li><li>不跟任何的框架或者容器捆绑，可以独立运行。</li></ol><h2 id="Spring-Security"><a href="#Spring-Security" class="headerlink" title="Spring Security"></a>Spring Security</h2><blockquote><p>除了不能脱离Spring，shiro的功能它都有。而且Spring Security对Oauth、OpenID也有支持,Shiro则需要自己手动实现。Spring Security的权限细粒度更高（笔者还未发现高在哪里）。</p></blockquote><blockquote><p>注：<br>OAuth在”客户端”与”服务提供商”之间，设置了一个授权层（authorization layer）。”客户端”不能直接登录”服务提供商”，只能登录授权层，以此将用户与客户端区分开来。”客户端”登录授权层所用的令牌（token），与用户的密码不同。用户可以在登录的时候，指定授权层令牌的权限范围和有效期。</p></blockquote><blockquote><p>“客户端”登录授权层以后，”服务提供商”根据令牌的权限范围和有效期，向”客户端”开放用户储存的资料。</p></blockquote><blockquote><p>OpenID 系统的第一部分是身份验证，即如何通过 URI 来认证用户身份。目前的网站都是依靠用户名和密码来登录认证，这就意味着大家在每个网站都需要注册用户名和密码，即便你使用的是同样的密码。如果使用 OpenID ，你的网站地址（URI）就是你的用户名，而你的密码安全的存储在一个 OpenID 服务网站上（你可以自己建立一个 OpenID 服务网站，也可以选择一个可信任的 OpenID 服务网站来完成注册）。</p></blockquote><blockquote><p>与OpenID同属性的身份识别服务商还有ⅥeID,ClaimID,CardSpace,Rapleaf,Trufina ID Card等，其中ⅥeID通用账户的应用最为广泛。</p></blockquote><h2 id="综述"><a href="#综述" class="headerlink" title="综述"></a>综述</h2><blockquote><p>个人认为现阶段需求，权限的操作粒度能控制在路径及按钮上，数据粒度通过sql实现。Shrio简单够用。</p></blockquote><blockquote><p>至于OAuth，OpenID 站点间统一登录功能，现租户与各个产品间单点登录已经通过cookies实现，所以Spring Security的这两个功能可以不考虑。</p></blockquote><blockquote><p>SpringSide网站的权限也是用Shrio做的。</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>Shiro, Spring Security</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GitHub利用Hexo搭建博客教程</title>
    <link href="/2018/02/20/2018/github_hexo_blog/"/>
    <url>/2018/02/20/2018/github_hexo_blog/</url>
    
    <content type="html"><![CDATA[<h3 id="安装Nodejs"><a href="#安装Nodejs" class="headerlink" title="安装Nodejs"></a>安装Nodejs</h3><p>nodo.js 下载与安装</p><p>下载地址：<br>官网<br>中文站<br>安装就不用多说了，跟安装普通软件没有区别，可以一路按提示Next。完成之后，打开命令行窗口 WIN + R，输入如下命令：</p><pre><code class="hljs bash">node -v    npm -v</code></pre><h3 id="安装git"><a href="#安装git" class="headerlink" title="安装git"></a>安装git</h3><p>百度自行安装</p><h3 id="安装-Hexo"><a href="#安装-Hexo" class="headerlink" title="安装 Hexo"></a>安装 Hexo</h3><p>在命令行输入如下命令:</p><blockquote><p>$ npm install -g hexo-cli</p></blockquote><p>由于众所周知的原因,可能你执行这条命令会报错，如果你不会调整姿势上网，可以使用淘宝 npm 镜像，执行如下命令即可：</p><blockquote><p>$ npm install -g cnpm –registry=<a href="https://registry.npm.taobao.org/">https://registry.npm.taobao.org</a></p></blockquote><p>之后很多 npm 命令可以使用 cnpm 代替。执行下面命令即可安装 Hexo :</p><blockquote><p>$ cnpm install -g hexo-cli</p></blockquote><p>可能出现一些 WARN ,可以不用理会，然后执行：</p><blockquote><p>$ cnpm install hexo –save</p></blockquote><p>输入 </p><blockquote><p>$ hexo -v </p></blockquote><p>出现所示的版本信息，则说明安装成功</p><h3 id="本地搭建博客"><a href="#本地搭建博客" class="headerlink" title="本地搭建博客"></a>本地搭建博客</h3><p>-初始化 hexo<br>新建一个文件夹，这个文件夹即为以后博客的文件存放路径。打开命令行，cd 到该文件夹，执行</p><blockquote><p>hexo init</p></blockquote><p>-生成静态文件，执行：</p><blockquote><p>hexo g</p></blockquote><p>OK,本地的博客搭建好了，下面可以执行 </p><blockquote><p>hexo s</p></blockquote><p>进行本地调试，执行完之后，打开浏览器，输入 <a href="http://localhost:4000,可以访问就成功了">http://localhost:4000,可以访问就成功了</a><br>那么恭喜你，本地博客搭建已经完成了。下一步就是部署到远程服务器上。</p><h3 id="将本地博客部署到远程服务器端"><a href="#将本地博客部署到远程服务器端" class="headerlink" title="将本地博客部署到远程服务器端"></a>将本地博客部署到远程服务器端</h3><p>本地博客搭建好了，我们还需要将它部署到远程服务器上。因为博客主要都是一些静态的页面，不涉及与后台的数据传送，所以我们可以利用 Github 上提供的一个免费空间，那么，首先需要有一个 Github 账号，相信同行都有，非猿类请登录官网注册。做法是建立一个仓库，将文件上传到该仓库即可，这个仓库的起名要注意，为 yourname.github.io，yourname与你的注册用户名一致,比如的github用户名是 zhangsan，那么起名就为 zhangsan.github.io ,这个就是你博客的域名了。</p><p>下面还需要做相应的配置，在你项目的文件夹下，找到 _config.yml 文件，注意是修改整个项目的配置文件，不是主题文件夹下的配置文件。打开文件修改配置如下：</p><pre><code class="hljs bash">deploy:      <span class="hljs-built_in">type</span>: git       repo: &lt;repository url&gt;        branch: [branch]        message: [message]</code></pre><p>参数描述：</p><blockquote><p>repo： 库（Repository）地址</p></blockquote><blockquote><p>branch： 分支名称。如果您使用的是 GitHub 或 GitCafe 的话，程序会尝试自动检测。</p></blockquote><blockquote><p>message: 自定义提交信息 (默认为 Site updated: ‘YYYY-MM-DD HH:mm:ss’</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>GitHub, Hexo, nodejs, javascript</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
